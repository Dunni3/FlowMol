"""
Valency lookup table for elements found in the GEOM-Drugs dataset, including implicit hydrogen counts.

This dictionary defines chemically plausible total valencies (sum of bond orders including hydrogens)
for atoms, indexed by atomic symbol and formal charge. It is used to determine atomic stability
in molecules generated by 3D molecular generative models.

Structure:
    {
        "ElementSymbol": {
            formal_charge (int): [list of allowed total valencies (int)]
        },
        ...
    }

This table was derived from the cleaned and filtered version of the GEOM-Drugs dataset.
"""

geom_drugs_h_valencies = {
    "Br": {0: [1], 1: [2]},
    "C": {0: [4], -1: [3], 1: [3]},
    "N": {0: [3], 1: [4], -1: [2], -2: [1]},
    "H": {0: [1]},
    "S": {0: [2, 6, 3], 1: [3], 2: [4], 3: [5, 2], -1: [1]},
    "O": {0: [2], -1: [1], 1: [3]},
    "F": {0: [1]},
    "Cl": {0: [1], 1: [2]},
    "P": {0: [5, 3], 1: [4]},
    "I": {0: [1], 1: [2], 2: [3]},
    "Si": {0: [4], 1: [5]},
    "B": {-1: [4], 0: [3]},
    "Bi": {2: [5], 0: [3]
           }
}

"""
Legacy valency table used in early molecular stability metrics, including chemically implausible entries.

This dictionary includes atomic valency assumptions used in prior works (e.g., MiDi, EQGAT, SemlaFlow).
It may include erroneous or outdated values due to improper handling of aromatic bond orders.

Structure:
    {
        "ElementSymbol": {
            formal_charge (int) or list of charges: allowed valency (int or list of int)
        }
    }

This table is retained only for backward compatibility and benchmarking of older models.
"""

geom_drugs_h_legacy_valencies = {
    "H": {0: 1, 1: 0, -1: 0},
    "C": {0: [3, 4], 1: 3, -1: 3},
    "N": {0: [2, 3], 1: [2, 3, 4], -1: 2},
    "O": {0: 2, 1: 3, -1: 1},
    "F": {0: 1, -1: 0},
    "B": 3,
    "Al": 3,
    "Si": 4,
    "P": {0: [3, 5], 1: 4},
    "S": {0: [2, 6], 1: [2, 3], 2: 4, 3: 5, -1: 3},
    "Cl": 1,
    "As": 3,
    "Br": {0: 1, 1: 2},
    "I": 1,
    "Hg": [1, 2],
    "Bi": [3, 5],
    "Se": [2, 4, 6],
}

"""
Valency lookup table capturing aromatic and non-aromatic bond contributions separately.

Each entry is indexed by:
    - atomic symbol (e.g., "C", "N"),
    - formal charge (int),
    - and maps to a list of tuples (n_aromatic_bonds, valence_from_non_aromatic_bonds).

This format allows for chemically rigorous validation of atoms participating in aromatic systems,
resolving ambiguities where assuming aromatic bond orders (e.g., 1.5) is insufficient.

Structure:
    {
        "ElementSymbol": {
            formal_charge (int): [(n_aromatic_bonds (int), valence_non_aromatic (int)), ...]
        },
        ...
    }

Derived from kekulized and sanitized GEOM-Drugs molecules with validated connectivity.
"""

geom_drugs_h_tuple_valencies = {
    "Br": {
        0: [(0, 1)],
        1: [(0, 2)],
    },
    "C": {
        0: [(0, 4), (2, 2), (2, 1), (3, 0)],
        -1: [(0, 3), (2, 1), (3, 0)],
        1: [(0, 3), (2, 1), (3, 0)],
    },
    "N": {
        0: [(0, 3), (2, 0), (2, 1), (3, 0)],
        1: [(0, 4), (2, 0), (2, 1), (2, 2), (3, 0)],
        -1: [(0, 2), (2, 0)],
        -2: [(0, 1)],
    },
    "H": {
        0: [(0, 1)],
    },
    "S": {
        0: [(0, 2), (0, 3), (0, 6), (2, 0)],
        1: [(0, 3), (2, 0), (2, 1), (3, 0)],
        2: [(0, 4), (2, 1), (2, 2)],
        3: [(0, 2), (0, 5)],
        -1: [(0, 1)],
    },
    "O": {
        0: [(0, 2), (2, 0)],
        -1: [(0, 1)],
        1: [(0, 3)],
    },
    "F": {
        0: [(0, 1)],
    },
    "Cl": {
        0: [(0, 1)],
        1: [(0, 2)],
    },
    "P": {
        0: [(0, 3), (0, 5)],
        1: [(0, 4)],
    },
    "I": {
        0: [(0, 1)],
        1: [(0, 2)],
        2: [(0, 3)],
    },
    "Si": {
        0: [(0, 4)],
        1: [(0, 5)],
    },
    "B": {
        -1: [(0, 4)],
        0: [(0, 3)],
    },
    "Bi": {
        0: [(0, 3)],
        2: [(0, 5)],
    }
}
